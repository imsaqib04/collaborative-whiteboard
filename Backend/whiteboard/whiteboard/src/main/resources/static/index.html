<!DOCTYPE html>
<html>
<head>
    <title>Real-Time Whiteboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.5.1/sockjs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
    <style>
        canvas { border: 2px solid #000; cursor: crosshair; }
    </style>
</head>
<body>
<h2>Collaboration Board</h2>
<canvas id="board" width="800" height="600"></canvas>

<script>
    var stompClient = null;
    var canvas = document.getElementById('board');
    var ctx = canvas.getContext('2d');
    var isDrawing = false;

    function connect() {
        var socket = new SockJS('/ws'); // Backend se connect karo
        stompClient = Stomp.over(socket);
        stompClient.connect({}, function (frame) {
            console.log('Connected: ' + frame);
            // Dusron ki drawing sunne ke liye subscribe karo
            stompClient.subscribe('/topic/board', function (message) {
                drawFromMessage(JSON.parse(message.body));
            });
        });
    }

    // Mouse Events
    canvas.addEventListener('mousedown', (e) => { isDrawing = true; sendDraw(e.offsetX, e.offsetY, "start"); });
    canvas.addEventListener('mousemove', (e) => {
        if (isDrawing) sendDraw(e.offsetX, e.offsetY, "draw");
    });
    canvas.addEventListener('mouseup', () => { isDrawing = false; });

    function sendDraw(x, y, type) {
        if(stompClient) {
            stompClient.send("/app/draw", {}, JSON.stringify({
                'x': x, 'y': y, 'color': 'black', 'type': type
            }));
        }
    }

    function drawFromMessage(msg) {
        // Asli logic yahan likhenge (Line draw karne ka)
        // Abhi ke liye bas console check karo
        if (msg.type === "draw") {
            ctx.fillStyle = msg.color;
            ctx.fillRect(msg.x, msg.y, 2, 2); // Simple dot banao test ke liye
        }
    }

    connect(); // Page load hote hi connect karo
</script>
</body>
</html>